(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{1069:function(e,t,n){"use strict";n.r(t);var o=n(242),r=n(243),s=n(245),a=n(247),c=n.n(a),i=n(255),u=n(259),l=n(956),h=n(244),f=n(590),p=n(617),m=n(246),d=(n(958),new h.a("input-with-vk")),v=function(e){function t(t){var n=e.call(this,t)||this;return n.setFocus=function(e){return n.setState({focused:e}),e&&n.context.focusNav.analytics.triggerFocusedEvent(),e||n.props.onCancelSearch&&n.props.onCancelSearch(),!0},n.moveLeft=function(){return n.inputRef&&n.inputRef.moveLeft()},n.moveRight=function(){return n.inputRef&&n.inputRef.moveRight()},n.moveUp=function(){return n.inputRef&&n.inputRef.moveUp()},n.moveDown=function(){return n.inputRef&&n.inputRef.moveDown()},n.exec=function(e){return n.inputRef&&n.inputRef.exec(e)},n.onRef=function(e){n.ref=e},n.onInputRef=function(e){e&&e.focusableRow&&(n.inputRef=e.focusableRow)},n.onInput=function(e){var t,o=n.props,r=o.onValueChange,s=o.value;"DEL"===e?s.length>0&&(t=s.substr(0,s.length-1)):t=s+e,t!==s&&r&&r(t)},n.onClick=function(){return n.context.focusNav.moveToRow(1)},n.state={focused:!1,curValue:""},n.focusableRow={focusable:!0,index:1,height:m.a.searchInputHeight,restoreSavedState:function(){},setFocus:n.setFocus,moveLeft:n.moveLeft,moveRight:n.moveRight,moveUp:n.moveUp,moveDown:n.moveDown,exec:n.exec},n}return Object(o.c)(t,e),t.prototype.componentDidMount=function(){this.focusableRow.ref=this.ref,this.context.focusNav.registerRow(this.focusableRow)},t.prototype.componentWillUnmount=function(){this.context.focusNav.unregisterRow(this.focusableRow)},t.prototype.componentDidUpdate=function(){this.focusableRow.savedState=Object.assign({},this.state)},t.prototype.render=function(){var e=this.props,t=e.className,n=e.value,o=e.placeholder,s=this.state.focused;return r.createElement("div",{className:d.b("",{focused:s}),ref:this.onRef,onClick:this.onClick,"aria-label":o,role:"presentation"},r.createElement("div",{className:c()(d.b({"has-value":!!n}),t,"content-margin")},r.createElement("div",{className:c()(d.e("background"),"full-bleed")}),r.createElement("div",{className:d.e("form"),role:"search"},r.createElement("div",{"aria-label":"Search",role:"textbox",className:c()(d.e("input",n?"hasText":""),"full-bleed")},r.createElement("div",{className:d.e("placeholder")},o)),r.createElement("div",{className:d.e("curValue")},r.createElement("div",{className:d.e("text")},n),r.createElement("div",{className:d.e("cursor",s?"focused":"")})),r.createElement("div",{className:d.e("icons")},r.createElement(f.a,{className:d.e("icon","search")})))),s?r.createElement("div",{className:d.e("keyboard")},r.createElement(p.a,{ref:this.onInputRef,handleKeyboardInput:this.onInput})):"")},t.contextTypes={focusNav:s.object.isRequired},t}(r.PureComponent),S=u.a.hasOSK(),g=function(e){function t(t){return e.call(this,t)||this}return Object(o.c)(t,e),t.prototype.render=function(){var e=this.props.intl,t=e.formatMessage({id:"search_input_placeholder"});return S?r.createElement(l.a,Object(o.a)({},this.props,{placeholder:"".concat("search_input_placeholder")})):r.createElement(v,Object(o.a)({},this.props,{placeholder:e.formatMessage({id:t})}))},t}(r.PureComponent),b=Object(i.d)(g),R=n(318),E=n(286),y=n(253),w=n(248),N=n(487),x=n(251),C=(n(959),new h.a("recent-searches")),I=function(e){function t(t){var n=e.call(this,t)||this;return n.setFocus=function(e){return n.setState({focused:e}),!0},n.moveLeft=function(){return"clearBtn"===n.state.focusState&&n.setState({focusState:"list",announceListName:!0}),!0},n.moveRight=function(){return"list"===n.state.focusState&&n.setState({focusState:"clearBtn"}),!0},n.moveUp=function(){var e=n.state,t=e.focusState,o=e.curIndex;return"list"===t&&o>0&&(n.setState({curIndex:o-1,announceListName:!1}),!0)},n.moveDown=function(){var e=n.state,t=e.focusState,o=e.curIndex,r=n.props.searches;return"list"===t&&o<r.length-1?(n.setState({curIndex:o+1,announceListName:!1}),!0):"clearBtn"===t&&(n.setState({focusState:"list"}),!0)},n.exec=function(e){switch(e){case y.a.CLICK:var t=n.state,o=t.focusState,r=t.curIndex;if("clearBtn"===o)n.onClearSearches(),n.context.focusNav.move(N.a.UP,!0);else if("list"===o){var s=n.props.searches[r],a="".concat(n.props.searchPagePath,"?q=").concat(encodeURIComponent(s));n.context.router.replace(a)}return!0;case y.a.ESC:return n.context.focusNav.move(N.a.UP,!0),!0}return!1},n.onClearSearches=function(){n.props.onClearSearches()},n.onRef=function(e){n.ref=e},n.handleMouseEnter=function(){!n.context.focusNav.disableMouseFocus&&n.context.focusNav.moveToRow(3)},n.mouseEnterSearchItem=function(e){n.setState({focusState:"list",curIndex:e})},n.clickSearchItem=function(){n.exec(y.a.CLICK)},n.mouseEnterClearBtn=function(){n.setState({focusState:"clearBtn"})},n.renderSearchItem=function(e,t,o){var s=n.state,a=s.focused,i=s.focusState,u=s.curIndex,l=s.announceListName,h="".concat(n.props.searchPagePath,"?q=").concat(encodeURIComponent(e)),f=a&&"list"===i&&u===t;return r.createElement(O,{key:t,index:t,totalItems:o.length,item:e,className:c()(C.e("item"),f?w.a:""),isFocused:f,location:h,containerLabel:l&&f?"@{search_recent_heading}":void 0,onMouseEnter:n.mouseEnterSearchItem,onClick:n.clickSearchItem})},n.state={focused:!1,focusState:"list",announceListName:!0,curIndex:0},n.focusableRow={focusable:!0,index:3,height:1,restoreSavedState:function(){},setFocus:n.setFocus,moveLeft:n.moveLeft,moveRight:n.moveRight,moveUp:n.moveUp,moveDown:n.moveDown,exec:n.exec},n}return Object(o.c)(t,e),t.prototype.componentDidMount=function(){this.focusableRow.ref=this.ref,this.context.focusNav.registerRow(this.focusableRow)},t.prototype.componentWillUnmount=function(){this.context.focusNav.unregisterRow(this.focusableRow)},t.prototype.componentDidUpdate=function(){this.focusableRow.savedState=Object.assign({},this.state),this.focusableRow.height=this.ref&&this.ref.clientHeight},t.prototype.render=function(){var e=this.props.searches,t=this.state.focused;return r.createElement("div",{className:C.b({focused:t}),ref:this.onRef,onMouseEnter:this.handleMouseEnter},r.createElement("header",{className:C.e("header")},r.createElement(i.a,{id:"search_recent_heading"},(function(e){return r.createElement("div",{className:C.e("heading")},e)}))),r.createElement("div",{className:c()(C.e("list"))},e.map(this.renderSearchItem)),this.renderClearButton())},t.prototype.renderClearButton=function(){var e=this,t=this.state,n=t.focused,o=t.focusState;return r.createElement(i.a,{id:"search_recent_clear_label_top"},(function(t){return r.createElement("button",{type:"button",onMouseEnter:e.mouseEnterClearBtn,onClick:e.onClearSearches,className:c()(C.e("clear"),n&&"clearBtn"===o?w.a:"")},t)}))},t.contextTypes={router:s.object.isRequired,focusNav:s.object.isRequired},t}(r.Component),O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleMouseEnter=function(){var e=t.props,n=e.onMouseEnter,o=e.index;n&&n(o)},t.handleMouseClick=function(){t.props.onClick&&t.props.onClick()},t}return Object(o.c)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.item,o=e.location,s=e.isFocused,a=e.containerLabel,i=Object(E.k)(this.props),u=i[0],l=i[1];return r.createElement("div",{className:t,onMouseEnter:this.handleMouseEnter,onClick:this.handleMouseClick},r.createElement(x.a,{tagName:R.Link,role:"",to:o,className:c()(C.e("link"),s?w.a:""),formattedAriaLabel:Object(E.b)([a,u]),values:l},n))},t}(r.Component),k=n(273),j=n(257),L=n(249),_=[function(e){function ResultsMovies(t){var n=e.call(this,t)||this,o=n.props.list,r=o&&o.items&&o.items.length>0&&Object(j.g)(n.props.list);return r&&(n.row=Object(L.k)(r)),n}return Object(o.c)(ResultsMovies,e),ResultsMovies.prototype.render=function(){var e=this.row;return e?r.createElement(e,Object(o.a)({},this.props,{maxItems:1/0})):r.createElement("div",null)},ResultsMovies}(r.Component),function(e){function ResultsTv(t){var n=e.call(this,t)||this;return n.row=Object(L.k)("poster"),n}return Object(o.c)(ResultsTv,e),ResultsTv.prototype.render=function(){var e=this.row;return e?r.createElement(e,Object(o.a)({},this.props,{maxItems:1/0})):r.createElement("div",null)},ResultsTv}(r.Component)],D=n(313),B=n(266),M=n(275),P=n(388),T=n(527),U=n(289),q=(n(960),new h.a("search-page")),K=function(e){function t(t){var n=e.call(this,t)||this;return n.shouldRenderEntry=function(e){var t=n.state.results;if(!t)return!1;var o=t.movies,r=t.tv,s=t.people;switch(e.template){case"results-movies":return o&&o.size>0;case"results-tv":return r&&r.size>0;case"results-people":return s&&!!s.length}return!1},n.onQueryChange=function(e){if(void 0!==e&&(e=e.replace(/^\s+/g,"").replace(/\s\s+/g," "))!==n.state.query){(!e.length||e.length<2)&&n.context.focusNav.pageResize(),n.updateQuery(e);var t=e?"?q=".concat(encodeURIComponent(e)):"";n.context.router.replace("".concat(n.props.searchPagePath).concat(t))}},n.onCancelSearch=function(){var e=n.state.query.trim(),t=n.props.recentResults;e&&t&&t.some((function(t){return t.term===e&&t.total>0}))&&n.props.searchSave(n.state.query)},n.formatEntryTitles=function(e){var t=n.props.intl.formatMessage;e.forEach((function(e){switch(e.template){case"results-movies":e.title=t({id:"search-movie-row-title"});break;case"results-tv":e.title=t({id:"search-tv-show-row-title"})}}))},n.state={query:""},n}return Object(o.c)(t,e),t.prototype.componentDidMount=function(){var e=this;this.checkRefreshQuery(this.props),this.context.focusNav.addEventHandler(k.b.KEYBOARD_VISIBILITY_CHANGE,"search",(function(t){e.context.focusNav.disableMouseFocus=t}))},t.prototype.componentWillUnmount=function(){this.context.focusNav.removeEventHandler(k.b.KEYBOARD_VISIBILITY_CHANGE,"search")},t.prototype.componentWillReceiveProps=function(e){this.checkRefreshQuery(e)},t.prototype.checkRefreshQuery=function(e){var t=e.location,n=e.customFields,o=e.recentResults,r=t.query.q||"";if(r!==this.state.query||n&&n.refresh)this.updateQuery(r);else if(r){var s=r.trim(),a=o.find((function(e){return e.term===s}));a&&this.setState({results:a})}else this.setState({results:void 0})},t.prototype.updateQuery=function(e){this.setState({query:e}),e.length>=2&&this.props.onSearch(e,!0,30)},t.prototype.isErrored=function(){var e=this.state.query.trim(),t=this.state.results;return(!t||t.term!==e)&&!!~this.props.erroredQueries.indexOf(e)},t.prototype.isLoading=function(){if(this.isErrored())return!1;var e=this.state.query.trim(),t=this.props.recentResults;return e&&e.length>=2&&(!t||!t.some((function(t){return t.term===e})))},t.prototype.render=function(){var e=!0;return(this.props.entries||[]).filter(this.shouldRenderEntry).length||(e=!1),r.createElement("div",{className:c()(q.b())},r.createElement(b,{onValueChange:this.onQueryChange,onCancelSearch:this.onCancelSearch,autoFocus:!0,value:this.state.query,loading:this.isLoading(),hasResults:e}),r.createElement("div",{className:c()(q.b("body"),"content-margin")}," ",this.renderSearchBody()," "))},t.prototype.renderSearchBody=function(){var e=this.props,t=e.entries,n=e.renderEntry;if(this.isErrored())return this.renderMessage("search_error_heading");if(1===this.state.query.length)return this.renderMessage("search_header_min_character_message");if(this.isLoading())return r.createElement(D.a,{className:q.e("spinner")});if(!this.state.query)return this.renderRecentSearches();if(this.state.results){var o=(t||[]).filter(this.shouldRenderEntry);return o.length?(this.formatEntryTitles(t),o.map(n)):this.renderMessage("search_header_empty_message")}},t.prototype.renderRecentSearches=function(){var e=this.props,t=e.recentSearches,n=e.onSearchClear;if(t.length)return r.createElement(I,{searches:t,searchPagePath:this.props.searchPagePath,onClearSearches:n})},t.prototype.renderMessage=function(e){return r.createElement(i.a,{id:e},(function(e){return r.createElement("div",{className:q.e("message")},r.createElement("div",{className:q.e("message-title")},e))}))},t.contextTypes={router:s.object.isRequired,focusNav:s.object.isRequired},t}(r.PureComponent);t.default=Object(U.b)(Object(i.d)(K),{key:M.Search,template:B.STATIC,mapStateToProps:function(e){var t=e.search,n=e.cache,o=e.app;return{recentSearches:t.recentSearches,recentResults:n.search.recentResults,searchPagePath:n.search.pagePath,erroredQueries:Object(T.a)(o.erroredActions)}},mapDispatchToProps:function(e){return{onSearch:function(t,n,o){return e(Object(P.d)(t,n,o))},onSearchClear:function(){return e(Object(P.e)())},searchSave:function(t){return e(Object(P.f)(t))}}},entryRenderers:_})},956:function(e,t,n){"use strict";(function(e){var o=n(242),r=n(243),s=n(245),a=n(244),c=n(324),i=n(259),u=n(275),l=n(490),h=n(253),f=n(273),p=n(249),m=n(248),d=n(246),v=(n(957),"input-with-osk"),S=new a.a(v),g=function(t){function n(n){var o=t.call(this,n)||this;return o.setFocus=function(e){if(!o.isGoingBackToSearch())return o.setState({focused:e}),e?(i.a.noAutoPopUpKeyboard&&o.setState({showOSK:!0}),o.context.focusNav.analytics.triggerFocusedEvent()):(o.setState({showOSK:!1}),o.props.onCancelSearch&&o.props.onCancelSearch()),!0},o.moveLeft=function(){return!0},o.moveRight=function(){return!0},o.moveUp=function(){return!1},o.moveDown=function(){return!1},o.exec=function(t){if(t===h.a.CLICK)e((function(){o.setState({showOSK:!0})}));else if(t===h.a.ESC)o.context.focusNav.moveToRow(0);else if(t===h.a.EXIT)return o.setState({showOSK:!1}),o.context.focusNav.moveToRow(0),!1;return Object(m.d)(t)},o.onValueChanged=function(e){var t=o.props.onValueChange,n=e.trim();n.length>48||(o.curValue=n,o.setState({curValue:n}),t&&t(n))},o.focusOnFirstResult=function(){e((function(){Object(p.H)((function(){return!o.props.loading}),(function(){o.props.hasResults&&(o.setState({showOSK:!1}),o.context.focusNav.move(c.a.Down,!0))}))}))},o.onClick=function(){return o.context.focusNav.moveToRow(1)},o.onBack=function(){o.state.showOSK?o.setState({showOSK:!1}):o.context.focusNav.handelEsc()},o.onDone=function(){o.props.onValueChange(o.curValue),o.setState({showOSK:!1}),o.focusOnFirstResult()},o.state={focused:!1,curValue:n.value,showOSK:!1},o.focusableRow={focusable:!0,index:1,height:d.a.searchInputHeight,restoreSavedState:function(){},setFocus:o.setFocus,moveLeft:o.moveLeft,moveRight:o.moveRight,moveUp:o.moveUp,moveDown:o.moveDown,exec:o.exec},o}return Object(o.c)(n,t),n.prototype.componentDidMount=function(){var e=this;this.focusableRow.ref=this.ref,this.context.focusNav.registerRow(this.focusableRow),this.context.focusNav.addEventHandler(f.b.KEYBOARD_VISIBILITY_CHANGE,v,(function(t){e.context.focusNav.disableMouseFocus=t,e.setState({showOSK:t})}))},n.prototype.componentWillUnmount=function(){this.context.focusNav.unregisterRow(this.focusableRow),this.context.focusNav.removeEventHandler(f.b.KEYBOARD_VISIBILITY_CHANGE,v)},n.prototype.componentWillReceiveProps=function(e){this.state.curValue!==e.value&&this.setState({curValue:e.value})},n.prototype.componentDidUpdate=function(){this.focusableRow.savedState=Object.assign({},this.state)},n.prototype.render=function(){var e=this,t=this.props.placeholder,n=this.state,o=n.focused,s=n.curValue;return r.createElement("div",{className:S.b({focused:o}),ref:function(t){return e.ref=t},onClick:this.onClick},r.createElement(l.a,{useOSK:!0,focused:o,value:s,maxLength:48,placeholder:t,className:S.e("search-osk"),valueChanged:this.onValueChanged,onBack:this.onBack,onDone:this.onDone}))},n.prototype.isGoingBackToSearch=function(){var e=this.context.focusNav,t=e.curPageTemplate,n=e.isGoingBack;return t===u.Search&&n},n.contextTypes={focusNav:s.object.isRequired},n}(r.Component);t.a=g}).call(this,n(294).setImmediate)},957:function(e,t,n){},958:function(e,t,n){},959:function(e,t,n){},960:function(e,t,n){}}]);